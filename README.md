# semantic-segmentation-cityscapes
中文
编码器-解码器结构是CNN图像分割模型的常见结构，其中编码器负责提取并压缩图像特征，然后将提取后的特征输送给解码器。解码器负责根据特征进行像素级的分类，最终输出和原始图像相同大小的像素分类结果。编码器-解码器结构虽然取得了不错的成果，但仍存在很多不足。编码器作为特征提取网络，常使用池化层逐渐缩减输入数据的空间维度，这虽然增加的后续卷积层的感受野，但也导致了位置信息的大量流失，对后续解码器恢复图像造成了一定的影响。编码器和解码器往往都由多层网络组成，这造成了编码器-解码器网络整体网络层数很深，网络结构较为复杂，而复杂的模型结构容易过拟合，这对网络结构设计、数据集增强等方面提出了更高要求。围绕以上问题，研究者们提出了诸多解决方法。2014年，Ronneberger等人提出了UNet网络用于医学图像分割，采用对称的编码器-解码器架构，使用卷积层逐渐缩小特征图的空间尺寸以捕获上下文信息，并通过跳跃连接将编码器的特征图直接传递给解码器从而保留了空间信息。SegNet是2017年由剑桥大学团队开发的图像分割的开源项目，也采用了对称的编码器-解码器网络架构，但其创新之处在于使用在对应编码器的最大池化步骤中计算的池化索引来执行非线性上采样。通过保留最大池化的下标，减少了特征图中空间信息的流失。2020年，Li等人从池化层操作出发，通过引入小波变化替代池化层来减少特征图下采样过程中的信息损失。WSegNet是一种用于图像分割的小波集成编码器-解码器网络，其结构上与SegNet和U-Net相似，但在上采样操作和下采样方法上有所不同。WSegNet采用2D离散小波变换（DWT）进行下采样操作，采用2D逆小波变换（IDWT）进行上采样操作。通过小波变换，编码器在下采样过程中将特征图分解为低频和高频分量，然后解码器利用IDWT从高频分量中恢复数据细节。
在本工作中，基于编码器-解码器网络结构设计图像分割模型。为减少下采样中的信息损失，作者尝试将UNet与WSegNet相结合，不但通过小波变换和逆变化分别替代编码器和解码器中的下采样和上采样操作，而且通过跳跃连接将编码器输出的特征图与上一级解码器输出的特征图做特征融合。针对CNN卷积操作严重依赖局部信息，无法很好地获得全局信息的缺点，在特征融合模块中引入自注意力机制，加强特征图上下文关联。通过小波变换和自注意力机制等改进，该网络在Cityscapes数据集上取得了不错的效果。

English Version
In this project, we designed an image segmentation model based on the encoder-decoder structure. To reduce information loss during downsampling, we combined UNet and WSegNet. We replaced downsampling and upsampling operations in the encoder and decoder with wavelet transforms and inverse transforms, respectively, and incorporated skip connections for feature fusion between encoder and decoder outputs. To address the CNN convolution operation's reliance on local information and inability to capture global context effectively, we introduced self-attention mechanisms in the feature fusion module to enhance contextual associations in feature maps. These improvements enabled our network to achieve promising results on the Cityscapes dataset.
